drop view VW_Prestataire_Image;
Create view VW_Prestataire_Image as 
Select log.libelle_logiciel,libelle_systeme,ext.raison_sociale_presta_externe,rue,ville,cp
From t_e_prestataire_image_ima ima  
Join t_e_prestataire_pre pre on pre.numero_prestataire = ima.Numero_Prestataire
Join t_e_prestataire_externe_ext ext on ext.Numero_Prestataire = ima.Numero_Prestataire
Join t_e_adresse_adr adr on adr.Code_Adresse = ext.Code_Adresse
Left Join t_j_logiciel_prestataire_lpr lpr on lpr.Numero_Prestataire = ima.numero_prestataire
Left Join t_r_logiciel_log log on log.numero_logiciel = lpr.numero_logiciel
Left Join t_j_systeme_prestataire_spr spr on spr.Numero_Prestataire = ima.Numero_Prestataire
Left Join t_r_systeme_sys s on s.Numero_Systeme = spr.Numero_Systeme;


Create view VW_Thematique_Type_Action as
Select t.numero_thematique,
ta1.Numero_Type_Action as Numero_Type_Action_Parent,
ta1.Libelle_Type_Action as Libelle_Type_Action_Parent,
ta1.Code_Type_Action as Code_Type_Action_Parent,
ta2.Numero_Type_Action as Numero_Type_Action_Enfant,
ta2.Libelle_Type_Action as Libelle_Type_Action_Enfant,
ta2.Code_Type_Action as Code_Type_Action_Enfant
From T_E_Thematique_THE t
Join T_J_Detail_thematique_DET dt on dt.Numero_Thematique = t.Numero_Thematique
Join T_R_Type_Action_TAC ta1 on ta1.Numero_Type_Action = dt.Numero_Type_Action
Left Join T_J_Couple_COU c on c.Numero_Type_Action = ta1.Numero_Type_Action
Left Join T_R_Type_Action_TAC ta2 on ta2.Numero_Type_Action = c.Numero_Type_Action